(()=>{todoarray=[],folderarray=[],window.onload=function(){null===localStorage.getItem("hasCodeRunBefore")&&(l(todoarray,folderarray),localStorage.setItem("hasCodeRunBefore",!0))},function(){try{todosfromstorage=JSON.parse(localStorage.getItem("todoarray")),foldersfromstorage=JSON.parse(localStorage.getItem("folderarray")),foldersfromstorage.length>0?folderarray=foldersfromstorage:todosfromstorage.length>0&&(todoarray=todosfromstorage)}catch{return!0}}(),folderarray.forEach((e=>{foldername=e,folderitem=document.createElement("li"),folderitem.classList.add("list-group-item"),folderitem.innerText=foldername,folderlist.appendChild(folderitem),folderitem.addEventListener("click",t)}));let e="";function t(e){oldselected=document.querySelector(".selectedfolder"),null!=oldselected&&oldselected.classList.remove("selectedfolder"),e.target.classList.add("selectedfolder"),d=document.querySelector("#deletefolderbutton"),d.classList.remove("hidden"),dt=document.querySelector("#deletetodobutton"),dt.classList.add("hidden"),r()}function o(e){oldselected=document.querySelector(".selectedtodo"),null!=oldselected&&oldselected.classList.remove("selectedtodo"),e.target.classList.add("selectedtodo"),d=document.querySelector("#deletetodobutton"),d.classList.remove("hidden")}function r(){const e=document.querySelector(".recentdelete");todolist=document.querySelector("#todolistgroup"),todolist.innerHTML="",selectedvalue=document.querySelector(".selectedfolder").textContent,todoarray.forEach((e=>{e.folder===selectedvalue&&(listitem=document.createElement("li"),listitem.id=e.id,listitem.classList.add("list-group-item"),listitem.addEventListener("click",o),listitem.innerText=e.description+" "+e.priority+" "+e.date,todolist.appendChild(listitem))})),e.classList.remove("recentdelete")}function l(e,t){localStorage.setItem("todoarray",JSON.stringify(e)),localStorage.setItem("folderarray",JSON.stringify(t))}document.querySelector("#createfolderbutton").addEventListener("click",(function(){foldername=document.querySelector("#foldernameinput").value,!0===folderarray.includes(foldername)?alert("Folder with that name already exists"):null!=foldername?(folderarray.push(foldername),foldername=document.querySelector("#foldernameinput").value,folderitem=document.createElement("li"),folderitem.classList.add("list-group-item",foldername),folderitem.innerText=foldername,folderlist.appendChild(folderitem),folderitem.addEventListener("click",t),document.querySelector("#foldernameinput").value="",l(todoarray,folderarray)):alert("Must be at least one character")})),document.querySelector("#deletefolderbutton").addEventListener("click",(function(e){d=document.querySelector("#deletefolderbutton"),selected=document.querySelector(".selectedfolder"),folderarray.forEach(((e,t)=>{e===selected.innerText&&folderarray.splice(t,1)})),tododomlist=document.querySelector("#todolistgroup"),tododomlist.innerHTML="",todoarray=todoarray.filter((e=>e.folder!=selected.innerText)),folderlist=document.querySelector("#folderlistgroup"),selected.remove(),d.classList.add("hidden"),todolist=document.querySelector("#todolistgroup"),todolist.innerHTML="",l()})),document.querySelector("#createtodobutton").addEventListener("click",(function(){const t=crypto.randomUUID();if(e=document.querySelector(".selectedfolder"),null!=e)if(a=new function(){this.description=document.querySelector("#tododescription").value,this.priorityvalue=document.querySelector("#priorityselect").value,this.priority=document.querySelector("#priorityselect").options[this.priorityvalue].innerText,this.date=document.querySelector("#dateselect").value,this.folder=document.querySelector(".selectedfolder").textContent,this.id=t},0!=todoarray.length&&""!=a.date)for(let e=0;e<todoarray.length;e++){if(a.folder===todoarray[e].folder&&a.description===todoarray[e].description)return void alert("Todo already posted!");if(e===todoarray.length-1){todoarray.push(a),l(todoarray,folderarray);break}}else""!=a.date&&(todoarray.push(a),l(todoarray,folderarray));else alert("pleaseselectfolder");r()})),document.querySelector("#deletetodobutton").addEventListener("click",(function(){selectedtodo=document.querySelector(".selectedtodo"),folderarray.forEach((()=>{todoarray.forEach(((e,t)=>{document.querySelector(".selectedfolder"),selectedtodo.innerText===e.description+" "+e.priority+" "+e.date&&e.id===selectedtodo.id&&(todoarray.splice(t,1),folderarray.splice(t,1))}))}));document.querySelector(".selectedfolder").classList.add("recentdelete"),selectedtodo.remove(),d=document.querySelector("#deletetodobutton"),d.classList.add("hidden")}))})();